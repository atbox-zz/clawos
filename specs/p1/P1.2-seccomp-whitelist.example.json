{
  "schema_version": "1.0.0",
  "whitelist_id": "550e8400-e29b-41d4-a716-446655440000",
  "created_at": "2026-02-24T00:00:00Z",
  "created_by": "Security Agent",
  "signature": "PLACEHOLDER_SHA256_SIGNATURE",
  "syscalls": [
    {
      "name": "mmap",
      "permission": "ALLOW",
      "category": "memory",
      "notes": "Memory mapping for Rust heap and code segments",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "munmap",
      "permission": "ALLOW",
      "category": "memory",
      "notes": "Memory unmapping for deallocation",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "mprotect",
      "permission": "ALLOW",
      "category": "memory",
      "notes": "Memory protection for JIT and dynamic code",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "brk",
      "permission": "ALLOW",
      "category": "memory",
      "notes": "Heap boundary adjustment (legacy, may be unused in modern Rust)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "madvise",
      "permission": "ALLOW",
      "category": "memory",
      "notes": "Memory advice for optimization",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "read",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File descriptor read operations",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "write",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File descriptor write operations",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "open",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File opening (legacy, openat preferred)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "openat",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File opening with directory fd (modern Rust std)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "close",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File descriptor closing",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "stat",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File status queries (legacy)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "fstat",
      "permission": "ALLOW",
      "category": "file_io",
      "notes": "File descriptor status queries",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "socket",
      "permission": "CONDITIONAL",
      "category": "network",
      "conditions": {
        "port_restriction": {
          "allowed_ports": [5432],
          "description": "PostgreSQL database port only"
        },
        "description": "Socket creation allowed only for PostgreSQL connections (port 5432). Additional port restrictions enforced by XDP layer."
      },
      "notes": "Network socket creation. Port restrictions enforced by XDP layer for additional security.",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "connect",
      "permission": "CONDITIONAL",
      "category": "network",
      "conditions": {
        "port_restriction": {
          "allowed_ports": [5432],
          "description": "PostgreSQL database port only"
        },
        "description": "Outbound connections allowed only to PostgreSQL (port 5432)"
      },
      "notes": "Outbound network connections. Port restrictions enforced by XDP layer.",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "recv",
      "permission": "ALLOW",
      "category": "network",
      "notes": "Receive data from socket",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "send",
      "permission": "ALLOW",
      "category": "network",
      "notes": "Send data to socket",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "poll",
      "permission": "ALLOW",
      "category": "network",
      "notes": "I/O multiplexing (legacy, epoll preferred)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "epoll_create1",
      "permission": "ALLOW",
      "category": "network",
      "notes": "Create epoll instance for async I/O",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "epoll_ctl",
      "permission": "ALLOW",
      "category": "network",
      "notes": "Control epoll instance (add/modify/remove file descriptors)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "epoll_wait",
      "permission": "ALLOW",
      "category": "network",
      "notes": "Wait for epoll events (core of tokio async runtime)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "clock_gettime",
      "permission": "ALLOW",
      "category": "time",
      "notes": "Get current time (used by tokio timers)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "clock_nanosleep",
      "permission": "ALLOW",
      "category": "time",
      "notes": "High-resolution sleep (used by tokio timers)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "rt_sigaction",
      "permission": "ALLOW",
      "category": "signals",
      "notes": "Install signal handler",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "rt_sigprocmask",
      "permission": "ALLOW",
      "category": "signals",
      "notes": "Modify signal mask",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "rt_sigreturn",
      "permission": "ALLOW",
      "category": "signals",
      "notes": "Return from signal handler",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "exit",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Terminate current thread",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "exit_group",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Terminate all threads in process",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "getpid",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Get process ID",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "futex",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Fast userspace mutex (core of Rust std::sync primitives)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "clone",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Create new thread/process (legacy)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "clone3",
      "permission": "ALLOW",
      "category": "process",
      "notes": "Create new thread/process (modern, preferred)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "prctl",
      "permission": "ALLOW",
      "category": "misc",
      "notes": "Process control operations (name, dumpable, etc.)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "getrandom",
      "permission": "ALLOW",
      "category": "misc",
      "notes": "Get random bytes from kernel (used by Rust RNG)",
      "verified_by_strace": true,
      "tokio_required": false
    },
    {
      "name": "eventfd2",
      "permission": "ALLOW",
      "category": "misc",
      "notes": "Event notification file descriptor (used by tokio)",
      "verified_by_strace": true,
      "tokio_required": true
    },
    {
      "name": "pipe2",
      "permission": "ALLOW",
      "category": "misc",
      "notes": "Create pipe with flags (used by tokio)",
      "verified_by_strace": true,
      "tokio_required": true
    }
  ],
  "metadata": {
    "target_process": "ironclaw",
    "environment": "production",
    "security_level": "strict",
    "tokio_version": "1.x",
    "rust_version": "1.75+",
    "notes": "This whitelist is based on IronClaw core requirements. Tokio async runtime syscalls (epoll_*, futex, clone3, eventfd2, pipe2, clock_*) are marked and will be verified via strace in Phase 2, Task C-02. Network syscalls (socket, connect) are restricted to PostgreSQL port 5432 with additional XDP layer enforcement."
  }
}
